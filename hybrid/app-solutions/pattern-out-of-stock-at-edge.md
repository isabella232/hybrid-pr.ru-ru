---
title: Обнаружение отсутствия товаров с помощью Azure и Azure Stack Edge
description: Узнайте, как с помощью служб Azure и устройства Azure Stack Edge отслеживать наличие товара.
author: BryanLa
ms.topic: article
ms.date: 05/24/2021
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 05/24/2021
ms.openlocfilehash: b25a6391c4e64fa7018031bac4fb7d098c56b529
ms.sourcegitcommit: cf2c4033d1b169f5b63980ce1865281366905e2e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2021
ms.locfileid: "110343881"
---
# <a name="out-of-stock-detection-at-the-edge-pattern"></a>Шаблон обнаружения отсутствия товаров на пограничных устройствах

В этом шаблоне показано, как определить отсутствие товаров на полках с помощью устройства Azure Stack Edge или Azure IoT Edge и сетевых камер.

## <a name="context-and-problem"></a>Контекст и проблема

В обычных розничных магазинах уровень продаж снижается из-за отсутствия нужного клиентам товара на полке. При этом товар может находиться на складе магазина, а его просто не вынесли в зал. Руководство магазинов хотело бы повысить эффективность работы сотрудников, включив возможность автоматического получения уведомлений о необходимости пополнить товар.

## <a name="solution"></a>Решение

В примере решения в каждом магазине используется пограничное устройство, например Azure Stack Edge, которое эффективно обрабатывает данные, получаемые с камер, в магазине. Такая оптимальная схема позволяет магазинам передавать в облако только нужные события и изображения. Конфигурация подразумевает экономию пропускной способности, пространства для хранения и обеспечивает конфиденциальность клиентов. По мере считывания кадров с каждой камеры модель машинного обучения обрабатывает изображение и возвращает все области, нуждающиеся в пополнении товарных запасов. Изображение и области, нуждающиеся в пополнении товарных запасов, отображаются в локальном веб-приложении. Эти данные можно отправить в среду "Аналитика временных рядов", чтобы отобразить аналитические сведения в Power BI.

![Архитектура решения для обнаружения отсутствия товара с помощью пограничного устройства](media/pattern-out-of-stock-at-edge/solution-architecture.png)

Решение работает следующим образом:

1. Изображения записываются из сетевой камеры по протоколу HTTP или RTSP.
2. Размер изображения изменяется, и изображение отправляется в драйвер вывода, который взаимодействует с моделью машинного обучения, чтобы определить, есть ли изображения с отсутствием товара.
3. Модель машинного обучения выводит все области, нуждающиеся в пополнении товарных запасов.
4. Драйвер вывода передает необработанное изображение в большой двоичный объект (если он указан) и отправляет результаты из модели в Центр Интернета вещей и обработчик ограничивающего прямоугольника на устройстве.
5. Обработчик ограничивающего прямоугольника добавляет ограничивающие прямоугольники на изображение и кэширует путь к изображению в выполняющейся в памяти базе данных.
6. Веб-приложение запрашивает изображения и показывает их в порядке получения.
7. Сообщения из Центра Интернета вещей объединяются в службе "Аналитика временных рядов".
8. В Power BI отображается интерактивный отчет о недостающих товарах за период времени и данные из службы "Аналитика временных рядов".


## <a name="components"></a>Components

Это решение использует следующие компоненты.

| Уровень | Компонент | Описание |
|----------|-----------|-------------|
| Локальное оборудование | Сетевая камера | Необходимо указать сетевую камеру с каналом HTTP или RTSP, чтобы предоставить изображения для вывода. |
| Azure | Центр Интернета вещей Azure | [Центр Интернета вещей](/azure/iot-hub/) осуществляет подготовку устройств и обмен сообщениями для пограничных устройств. |
|  | Azure Time Series Insights | В [службе "Аналитика временных рядов Azure"](/azure/time-series-insights/) хранятся сообщения из Центра Интернета вещей для визуализации. |
|  | В Power BI. | [Microsoft Power BI](https://powerbi.microsoft.com/) предоставляет бизнес-отчеты о случаях отсутствия товарных запасов. Power BI предоставляет простой в использовании интерфейс панели мониторинга для просмотра выходных данных Azure Stream Analytics. |
| Устройство Azure Stack Edge или<br>Azure IoT Edge | Azure IoT Edge | [Azure IoT Edge](/azure/iot-edge/) управляет средой выполнения для локальных контейнеров и осуществляет управление устройствами и обновлениями.|
| | Project Brainwave в Azure | На устройстве Azure Stack Edge [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) использует программируемые пользователем вентильные матрицы для ускорения вывода Машинного обучения.|

## <a name="issues-and-considerations"></a>Проблемы и рекомендации

Во время выбора варианта реализации этого решения необходимо учитывать приведенные ниже моменты.

### <a name="scalability"></a>Масштабируемость

Большинство моделей машинного обучения могут работать только с определенным количеством кадров в секунду в зависимости от предоставленного оборудования. Определите оптимальную частоту выборки для камер, чтобы конвейер Машинного обучения не выполнял резервное копирование. Оборудование различных типов будет работать с разным количеством камер и частотой кадров.

### <a name="availability"></a>Доступность

Важно предусмотреть сценарий, когда у пограничного устройства пропадает подключение. Определите, какие данные могут быть потеряны из службы "Аналитика временных рядов" и панели мониторинга Power BI. Приведенный пример решения не предусматривает высокую доступность.

### <a name="manageability"></a>Управляемость

Это решение может масштабироваться на множество устройств и расположений, что может оказаться неудобным. Службы Интернета вещей Azure могут автоматически переводить новые расположения и устройства в режим подключения и обновлять их. Необходимо также соблюдать надлежащие процедуры управления данными.

### <a name="security"></a>Безопасность

Этот шаблон подразумевает обработку потенциально конфиденциальных данных. Убедитесь, что ключи регулярно меняются, а разрешения для учетной записи хранения Azure и локальных общих папок заданы правильно.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения по темам, описанным в этой статье:
- В этом шаблоне используются несколько служб, связанных с Интернетом вещей, в том числе [Azure IoT Edge](/azure/iot-edge/), [Центр Интернета вещей](/azure/iot-hub/) и [служба "Аналитика временных рядов Azure"](/azure/time-series-insights/).
- Чтобы узнать больше о Microsoft Project Brainwave, ознакомьтесь с [объявлением блога](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) и просмотрите видео [об ускоренном Машинном обучении Azure с Project Brainwave](https://www.youtube.com/watch?v=DJfMobMjCX0).
- См. [рекомендации по проектированию гибридных приложений и ответы на дополнительные вопросы](overview-app-design-considerations.md).
- См. сведения обо [всех продуктах и решениях Azure Stack](/azure-stack).

Когда вы будете готовы протестировать пример решения, переходите к [руководству по развертыванию решения вывода ML Edge](https://aka.ms/edgeinferencingdeploy). В этом руководстве содержатся пошаговые инструкции по развертыванию и тестированию компонентов.
